<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIA Plan Comparison Tool</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { font-family: 'Noto Sans Thai', sans-serif; }
        /* Custom Scrollbar for better UX */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen text-slate-800">

    <div class="max-w-[1400px] mx-auto bg-white shadow-xl border border-gray-200 md:my-6 md:rounded-xl overflow-hidden">
        
        <!-- Header -->
        <div class="bg-gradient-to-r from-slate-800 to-slate-900 p-4 md:p-6 text-white text-center shadow-md relative">
            <h1 class="text-xl md:text-3xl font-bold flex items-center justify-center gap-2">
               <i data-lucide="file-text" class="text-yellow-400 w-6 h-6 md:w-8 md:h-8"></i>
               ตารางเปรียบเทียบ AIA
            </h1>
            <p class="text-slate-300 mt-1 text-xs md:text-sm opacity-90">ข้อมูลจาก Compare HSX HSV HH (Blank)</p>
        </div>

        <!-- Mobile Controls (Visible only on mobile) -->
        <div id="mobile-controls" class="md:hidden p-4 bg-white border-b-4 border-slate-100 sticky top-0 z-30 shadow-sm">
            <div class="text-sm font-bold text-gray-700 mb-3 flex items-center gap-2">
                <i data-lucide="activity" class="text-blue-500 w-4 h-4"></i> เลือกแผนเพื่อเปรียบเทียบ
            </div>
            <div class="grid grid-cols-2 gap-3">
                <!-- Col 1 Control -->
                <div class="rounded-lg border border-gray-200 p-3 bg-slate-50 relative">
                    <div class="absolute top-0 right-0 bg-blue-500 text-white text-[10px] px-2 py-0.5 rounded-bl-lg rounded-tr-lg font-bold">A</div>
                    <div class="text-xs text-gray-500 mb-1 font-semibold">แผนซ้าย</div>
                    <select id="mobile-type-col1" class="w-full p-1.5 rounded border border-gray-300 text-xs mb-2 bg-white" onchange="updatePlan('col1', this.value, 0)">
                        <option value="HSX">H&S Extra</option>
                        <option value="HSV">Health Saver</option>
                        <option value="HH">Health Happy</option>
                    </select>
                    <select id="mobile-idx-col1" class="w-full p-1.5 rounded border border-gray-300 text-xs bg-white" onchange="updatePlanIdx('col1', this.value)">
                        <!-- Options populated by JS -->
                    </select>
                </div>
                <!-- Col 2 Control -->
                <div class="rounded-lg border border-gray-200 p-3 bg-slate-50 relative">
                    <div class="absolute top-0 right-0 bg-purple-500 text-white text-[10px] px-2 py-0.5 rounded-bl-lg rounded-tr-lg font-bold">B</div>
                    <div class="text-xs text-gray-500 mb-1 font-semibold">แผนกลาง</div>
                    <select id="mobile-type-col2" class="w-full p-1.5 rounded border border-gray-300 text-xs mb-2 bg-white" onchange="updatePlan('col2', this.value, 0)">
                        <option value="HSX">H&S Extra</option>
                        <option value="HSV">Health Saver</option>
                        <option value="HH">Health Happy</option>
                    </select>
                    <select id="mobile-idx-col2" class="w-full p-1.5 rounded border border-gray-300 text-xs bg-white" onchange="updatePlanIdx('col2', this.value)">
                        <!-- Options populated by JS -->
                    </select>
                </div>
            </div>
            <div class="mt-2 text-[10px] text-center text-gray-400">*เลื่อนตารางด้านล่างเพื่อดูรายละเอียด</div>
        </div>

        <!-- Table Container -->
        <div class="overflow-x-auto">
            <table class="w-full min-w-[900px] border-collapse text-sm md:text-base">
                <thead>
                    <tr>
                        <!-- Label Column Header -->
                        <th class="p-4 w-[25%] bg-white text-left sticky left-0 z-20 border-r border-gray-200 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.1)] align-bottom pb-6">
                            <span class="hidden md:block text-gray-400 text-xs font-normal mb-1">เลือกแผนเพื่อเปรียบเทียบ</span>
                            <div class="text-lg md:text-xl font-bold text-gray-800">รายการความคุ้มครอง</div>
                        </th>
                        
                        <!-- Column 1 Header -->
                        <th id="header-col1" class="p-4 w-[25%] align-top border-b-4 transition-colors duration-300">
                            <!-- Content injected by JS -->
                        </th>

                        <!-- Column 2 Header -->
                        <th id="header-col2" class="p-4 w-[25%] align-top border-b-4 transition-colors duration-300">
                             <!-- Content injected by JS -->
                        </th>

                        <!-- Column 3 Header -->
                        <th id="header-col3" class="p-4 w-[25%] align-top border-b-4 transition-colors duration-300">
                             <!-- Content injected by JS -->
                        </th>
                    </tr>
                </thead>
                <tbody id="table-body" class="divide-y divide-gray-100">
                    <!-- Rows injected by JS -->
                </tbody>
            </table>
        </div>

        <!-- Footer Note -->
        <div class="bg-white p-4 border-t border-gray-200">
            <div class="flex items-start gap-2 text-xs text-gray-500 bg-gray-50 p-3 rounded-lg border border-gray-100">
                <i data-lucide="alert-circle" class="w-4 h-4 mt-0.5 text-gray-400 flex-shrink-0"></i>
                <div>
                    <span class="font-bold">หมายเหตุ:</span> 
                    <ul class="list-disc ml-4 mt-1 space-y-1">
                        <li>HSX (H&S Extra) เป็นแบบแยกค่าใช้จ่ายรายหมวด ส่วนเกินจากวงเงินผู้เอาประกันภัยรับผิดชอบเอง</li>
                        <li>HSV (Health Saver) หมวด 3-6 และ 12 เป็นวงเงินใช้ร่วมกันแบบเหมาจ่ายภายใต้วงเงินแผน</li>
                        <li>โรคร้ายแรง (CI) ของ Health Saver และ Health Happy จะเบิ้ลวงเงินให้เป็น 2 เท่าในปีที่ตรวจเจอและต่อเนื่องไปอีก 3 ปีกรมธรรม์</li>
                        <li>ข้อมูลนี้เป็นการสรุปเพื่อความเข้าใจเบื้องต้น โปรดศึกษารายละเอียดข้อยกเว้นในเล่มกรมธรรม์ฉบับสมบูรณ์</li>
                    </ul>
                </div>
            </div>
        </div>

    </div>

    <!-- Scripts -->
    <script>
        // --- DATA ---
        const plansData = {
            HSX: {
                name: "AIA H&S Extra (HSX)",
                subtitle: "ค่ารักษาแบบแยกรายหมวด + มี OPD",
                color: "bg-emerald-50 border-emerald-200 text-emerald-900",
                headerColor: "bg-emerald-100",
                accentColor: "text-emerald-700",
                options: [
                    { id: "hsx_2000", name: "แผน 2000", cat1_room: "2,000", cat1_icu: "4,000", cat2_med: "20,000", cat3_surg: "80,000", cat4_doc: "800", cat5_day_surg: "80,000", cat6_diag: "5,000", cat7_acc: "4,000", cat8_rehab: "2,000", cat9_kidney: "15,000", cat10_cancer: "15,000", cat11_amb: "2,000", cat12_minor: "8,000", cat13_opd: "4,000 /ปี", ci: "ไม่คุ้มครอง", ncb: "2,000", death: "10,000", limit_confinement: "จำกัดวงเงินต่อครั้ง", limit_annual: "ไม่จำกัดวงเงินต่อปี" },
                    { id: "hsx_2500", name: "แผน 2500", cat1_room: "2,500", cat1_icu: "5,000", cat2_med: "25,000", cat3_surg: "100,000", cat4_doc: "1,000", cat5_day_surg: "100,000", cat6_diag: "7,500", cat7_acc: "5,000", cat8_rehab: "2,500", cat9_kidney: "20,000", cat10_cancer: "20,000", cat11_amb: "3,000", cat12_minor: "10,000", cat13_opd: "5,000 /ปี", ci: "ไม่คุ้มครอง", ncb: "2,500", death: "10,000", limit_confinement: "จำกัดวงเงินต่อครั้ง", limit_annual: "ไม่จำกัดวงเงินต่อปี" },
                    { id: "hsx_5500", name: "แผน 5500", cat1_room: "5,500", cat1_icu: "11,000", cat2_med: "45,000", cat3_surg: "140,000", cat4_doc: "2,000", cat5_day_surg: "140,000", cat6_diag: "15,000", cat7_acc: "7,000", cat8_rehab: "4,500", cat9_kidney: "30,000", cat10_cancer: "30,000", cat11_amb: "5,000", cat12_minor: "14,000", cat13_opd: "9,000 /ปี", ci: "ไม่คุ้มครอง", ncb: "4,000", death: "10,000", limit_confinement: "จำกัดวงเงินต่อครั้ง", limit_annual: "ไม่จำกัดวงเงินต่อปี" }
                ]
            },
            HSV: {
                name: "AIA Health Saver (HSV)",
                subtitle: "เหมาจ่ายเริ่มต้น (เบิ้ล CI 2 เท่า)",
                color: "bg-sky-50 border-sky-200 text-sky-900",
                headerColor: "bg-sky-100",
                accentColor: "text-sky-700",
                options: [
                    { id: "hsv_300k", name: "แผน 3 แสน", cat1_room: "2,000", cat1_icu: "12,000", cat2_med: "เหมาจ่าย (3แสน)", cat3_surg: "เหมาจ่ายร่วม", cat4_doc: "1,000", cat5_day_surg: "เหมาจ่ายร่วม", cat6_diag: "เหมาจ่ายร่วม", cat7_acc: "5,000", cat8_rehab: "2,000", cat9_kidney: "15,000", cat10_cancer: "15,000", cat11_amb: "3,000", cat12_minor: "เหมาจ่ายร่วม", cat13_opd: "ไม่คุ้มครอง", ci: "2 เท่า (6 แสน)", ncb: "ไม่มี", death: "10,000", limit_confinement: "เหมาจ่ายหมวด 3-6,12", limit_annual: "สูงสุด 300,000 ต่อปี" },
                    { id: "hsv_400k", name: "แผน 4 แสน", cat1_room: "3,000", cat1_icu: "18,000", cat2_med: "เหมาจ่าย (4แสน)", cat3_surg: "เหมาจ่ายร่วม", cat4_doc: "1,200", cat5_day_surg: "เหมาจ่ายร่วม", cat6_diag: "เหมาจ่ายร่วม", cat7_acc: "6,000", cat8_rehab: "2,500", cat9_kidney: "20,000", cat10_cancer: "20,000", cat11_amb: "4,000", cat12_minor: "เหมาจ่ายร่วม", cat13_opd: "1,000/ครั้ง (30ครั้ง/ปี)", ci: "2 เท่า (8 แสน)", ncb: "ไม่มี", death: "10,000", limit_confinement: "เหมาจ่ายหมวด 3-6,12", limit_annual: "สูงสุด 400,000 ต่อปี" },
                    { id: "hsv_500k", name: "แผน 5 แสน", cat1_room: "4,000", cat1_icu: "24,000", cat2_med: "เหมาจ่าย (5แสน)", cat3_surg: "เหมาจ่ายร่วม", cat4_doc: "1,500", cat5_day_surg: "เหมาจ่ายร่วม", cat6_diag: "เหมาจ่ายร่วม", cat7_acc: "7,000", cat8_rehab: "3,000", cat9_kidney: "25,000", cat10_cancer: "25,000", cat11_amb: "5,000", cat12_minor: "เหมาจ่ายร่วม", cat13_opd: "1,500/ครั้ง (30ครั้ง/ปี)", ci: "2 เท่า (1 ล้าน)", ncb: "ไม่มี", death: "10,000", limit_confinement: "เหมาจ่ายหมวด 3-6,12", limit_annual: "สูงสุด 500,000 ต่อปี" }
                ]
            },
            HH: {
                name: "AIA Health Happy (HH)",
                subtitle: "เหมาจ่ายปลดล็อควงเงิน",
                color: "bg-pink-50 border-pink-200 text-pink-900",
                headerColor: "bg-pink-100",
                accentColor: "text-pink-700",
                options: [
                    { id: "hh_1m", name: "แผน 1 ล้าน", cat1_room: "1,500", cat1_icu: "เหมาจ่าย", cat2_med: "เหมาจ่าย", cat3_surg: "เหมาจ่าย", cat4_doc: "เหมาจ่าย", cat5_day_surg: "เหมาจ่าย", cat6_diag: "เหมาจ่าย", cat7_acc: "เหมาจ่าย", cat8_rehab: "เหมาจ่าย", cat9_kidney: "เหมาจ่าย", cat10_cancer: "เหมาจ่าย", cat11_amb: "เหมาจ่าย", cat12_minor: "เหมาจ่าย", cat13_opd: "ไม่คุ้มครอง", ci: "2 เท่า (2 ล้าน)", ncb: "ไม่มี", death: "10,000", limit_confinement: "เหมาจ่ายตามจริง", limit_annual: "สูงสุด 1 ล้านบาท/ปี" },
                    { id: "hh_5m", name: "แผน 5 ล้าน", cat1_room: "3,000", cat1_icu: "เหมาจ่าย", cat2_med: "เหมาจ่าย", cat3_surg: "เหมาจ่าย", cat4_doc: "เหมาจ่าย", cat5_day_surg: "เหมาจ่าย", cat6_diag: "เหมาจ่าย", cat7_acc: "เหมาจ่าย", cat8_rehab: "เหมาจ่าย", cat9_kidney: "เหมาจ่าย", cat10_cancer: "เหมาจ่าย", cat11_amb: "เหมาจ่าย", cat12_minor: "เหมาจ่าย", cat13_opd: "ไม่คุ้มครอง", ci: "2 เท่า (10 ล้าน)", ncb: "ไม่มี", death: "10,000", limit_confinement: "เหมาจ่ายตามจริง", limit_annual: "สูงสุด 5 ล้านบาท/ปี" },
                    { id: "hh_25m", name: "แผน 25 ล้าน", cat1_room: "9,000", cat1_icu: "เหมาจ่าย", cat2_med: "เหมาจ่าย", cat3_surg: "เหมาจ่าย", cat4_doc: "เหมาจ่าย", cat5_day_surg: "เหมาจ่าย", cat6_diag: "เหมาจ่าย", cat7_acc: "เหมาจ่าย", cat8_rehab: "เหมาจ่าย", cat9_kidney: "เหมาจ่าย", cat10_cancer: "เหมาจ่าย", cat11_amb: "เหมาจ่าย", cat12_minor: "เหมาจ่าย", cat13_opd: "2,000/ครั้ง (30ครั้ง/ปี)", ci: "2 เท่า (50 ล้าน)", ncb: "ไม่มี", death: "10,000", limit_confinement: "เหมาจ่ายตามจริง", limit_annual: "สูงสุด 25 ล้านบาท/ปี" }
                ]
            }
        };

        // --- STATE ---
        let state = {
            col1: { type: 'HSX', index: 1 },
            col2: { type: 'HSV', index: 1 },
            col3: { type: 'HH', index: 1 }
        };

        // --- FUNCTIONS ---
        
        function getPlanData(colKey) {
            const { type, index } = state[colKey];
            const typeData = plansData[type];
            const planDetail = typeData.options[index];
            return { ...planDetail, ...typeData };
        }

        function renderCell(value) {
            if (value === "เหมาจ่าย" || value === "เหมาจ่ายตามจริง") 
                return `<span class="font-bold text-pink-600">เหมาจ่ายตามจริง</span>`;
            if (value === "เหมาจ่ายร่วม" || value.includes("เหมาจ่าย (")) 
                return `<span class="text-sky-600 font-medium">เหมาจ่ายในวงเงิน</span>`;
            if (value === "ไม่คุ้มครอง") 
                return `<span class="text-gray-300">-</span>`;
            return `<span class="text-gray-800">${value}</span>`;
        }

        function updatePlan(col, type, index) {
            state[col] = { type, index };
            renderAll();
        }

        function updatePlanIdx(col, index) {
            state[col].index = parseInt(index);
            renderAll();
        }

        function renderDropdown(colKey, currentType, currentIndex, isMobile = false) {
            const idPrefix = isMobile ? 'mobile' : 'desktop';
            // Need to update the <select> values in DOM if they exist
            // However, re-rendering whole header handles desktop. 
            // Mobile controls are static in HTML, need to update their values.
            
            if (isMobile) {
                const typeSelect = document.getElementById(`mobile-type-${colKey}`);
                if (typeSelect) typeSelect.value = currentType;

                const idxSelect = document.getElementById(`mobile-idx-${colKey}`);
                if (idxSelect) {
                    idxSelect.innerHTML = plansData[currentType].options.map((opt, i) => 
                        `<option value="${i}" ${i === currentIndex ? 'selected' : ''}>${opt.name}</option>`
                    ).join('');
                }
            } else {
                // Return HTML string for Desktop Header Dropdown
                const typeOptions = Object.keys(plansData).map(key => 
                    `<option value="${key}" ${key === currentType ? 'selected' : ''}>${plansData[key].name.split('(')[0].trim()}</option>`
                ).join('');
                
                const planOptions = plansData[currentType].options.map((opt, i) => 
                    `<option value="${i}" ${i === currentIndex ? 'selected' : ''}>${opt.name}</option>`
                ).join('');

                return `
                    <div class="space-y-2 mt-2 hidden md:block">
                        <select class="w-full p-2 rounded border border-gray-300 text-sm font-semibold bg-white/70 focus:ring-2 focus:ring-blue-400 outline-none"
                                onchange="updatePlan('${colKey}', this.value, 0)">
                            ${typeOptions}
                        </select>
                        <select class="w-full p-2 rounded border border-gray-300 text-sm bg-white/90 focus:ring-2 focus:ring-blue-400 outline-none shadow-sm"
                                onchange="updatePlanIdx('${colKey}', this.value)">
                            ${planOptions}
                        </select>
                    </div>
                `;
            }
        }

        function renderHeader(colKey) {
            const data = getPlanData(colKey);
            const headerCell = document.getElementById(`header-${colKey}`);
            
            // Apply Classes
            headerCell.className = `p-4 w-[25%] align-top border-b-4 transition-colors duration-300 ${data.headerColor.replace('bg-', 'border-').replace('100', '300')} ${data.headerColor}`;
            
            // Content
            headerCell.innerHTML = `
                <div class="flex flex-col gap-2">
                    <div>
                        <div class="text-lg font-bold ${data.accentColor}">${data.name}</div>
                        <div class="text-xs text-gray-600 font-normal">${data.subtitle}</div>
                    </div>
                    ${renderDropdown(colKey, state[colKey].type, state[colKey].index, false)}
                </div>
            `;
        }

        function createRowHtml(label, iconName, key, note = "") {
            const c1 = getPlanData('col1');
            const c2 = getPlanData('col2');
            const c3 = getPlanData('col3');
            
            return `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="p-3 pl-4 md:pl-6 sticky left-0 bg-white border-r border-gray-200 font-medium text-gray-700 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]">
                        <div class="flex items-center gap-2">
                            ${iconName ? `<i data-lucide="${iconName}" class="text-blue-500 w-4 h-4 shrink-0"></i>` : ''}
                            ${label}
                        </div>
                        ${note ? `<div class="text-xs text-gray-400 ml-6 hidden md:block">${note}</div>` : ''}
                    </td>
                    <td class="p-3 text-center text-gray-800">${renderCell(c1[key])}</td>
                    <td class="p-3 text-center text-gray-800">${renderCell(c2[key])}</td>
                    <td class="p-3 text-center text-gray-800">${renderCell(c3[key])}</td>
                </tr>
            `;
        }
        
        function createSectionHeader(title) {
             return `<tr class="bg-gray-100 border-y border-gray-200"><td colSpan="4" class="py-2 px-4 font-bold text-gray-700 text-sm tracking-wide">${title}</td></tr>`;
        }

        function renderBody() {
            const tbody = document.getElementById('table-body');
            let html = '';

            // Section 1
            html += createSectionHeader("1. ผลประโยชน์กรณีผู้ป่วยใน (IPD)");
            html += createRowHtml("ค่าห้อง ค่าอาหาร (ต่อวัน)", "heart", "cat1_room", "สูงสุด 125 วัน หรือ 365 วัน");
            html += createRowHtml("ค่าห้อง ICU (ต่อวัน)", "activity", "cat1_icu");
            html += createRowHtml("หมวด 2: บริการทางการแพทย์", "stethoscope", "cat2_med", "ค่ายา, เวชภัณฑ์, เลือด");
            html += createRowHtml("หมวด 3: ผ่าตัด/หัตถการ", null, "cat3_surg");
            html += createRowHtml("หมวด 4: เยี่ยมไข้ (ต่อวัน)", null, "cat4_doc");
            html += createRowHtml("หมวด 5: ผ่าตัดใหญ่ไม่ต้องนอน", null, "cat5_day_surg");

            // Section 2
            html += createSectionHeader("2. ผลประโยชน์ค่ารักษาพยาบาลอื่นๆ");
            html += createRowHtml("หมวด 6: ตรวจวินิจฉัย", null, "cat6_diag");
            html += createRowHtml("หมวด 7: อุบัติเหตุฉุกเฉิน", "zap", "cat7_acc");
            html += createRowHtml("หมวด 8: เวชศาสตร์ฟื้นฟู", null, "cat8_rehab");
            html += createRowHtml("หมวด 9: ล้างไต", null, "cat9_kidney");
            html += createRowHtml("หมวด 10: รักษามะเร็ง", null, "cat10_cancer");
            html += createRowHtml("หมวด 11: รถพยาบาล", "truck", "cat11_amb");
            html += createRowHtml("หมวด 12: ผ่าตัดเล็ก", null, "cat12_minor");
            
            // OPD
            const c1 = getPlanData('col1'), c2 = getPlanData('col2'), c3 = getPlanData('col3');
            const opdRow = `
                <tr class="hover:bg-orange-50 transition-colors bg-orange-50/30 border-t border-orange-100">
                    <td class="p-3 pl-4 md:pl-6 sticky left-0 bg-white border-r border-gray-200 font-medium text-gray-700 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]">
                       <div class="flex items-center gap-2"><i data-lucide="user-plus" class="text-orange-500 w-4 h-4 shrink-0"></i>หมวด 13: ผู้ป่วยนอก (OPD)</div>
                    </td>
                    ${[c1, c2, c3].map(c => `<td class="p-3 text-center">${c.cat13_opd === "ไม่คุ้มครอง" ? '<span class="text-gray-300">-</span>' : `<span class="bg-orange-100 text-orange-700 px-3 py-1 rounded-full text-xs md:text-sm font-bold border border-orange-200 shadow-sm whitespace-nowrap">${c.cat13_opd}</span>`}</td>`).join('')}
                </tr>
            `;
            html += opdRow;

            // Section 3
            html += createSectionHeader("3. ผลประโยชน์เพิ่มเติมพิเศษ");
            
            // CI Double
            html += `
                <tr class="hover:bg-red-50 transition-colors">
                    <td class="p-3 pl-4 md:pl-6 sticky left-0 bg-white border-r border-gray-200 font-medium text-gray-700 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]">
                       <div class="flex items-center gap-2"><i data-lucide="shield" class="text-red-500 w-4 h-4 shrink-0"></i>เบิ้ลความคุ้มครองโรคร้ายแรง</div>
                       <div class="text-xs text-gray-400 ml-6 hidden md:block">ปีที่เป็น + 3 ปีต่อเนื่อง</div>
                    </td>
                    ${[c1, c2, c3].map(c => `<td class="p-3 text-center text-sm">${c.ci === "ไม่คุ้มครอง" ? '-' : `<span class="text-red-600 font-bold bg-red-50 px-2 py-1 rounded border border-red-100">${c.ci}</span>`}</td>`).join('')}
                </tr>
            `;

            // NCB
             html += `
                <tr class="hover:bg-emerald-50 transition-colors">
                    <td class="p-3 pl-4 md:pl-6 sticky left-0 bg-white border-r border-gray-200 font-medium text-gray-700 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]">
                       <div class="flex items-center gap-2"><i data-lucide="dollar-sign" class="text-emerald-500 w-4 h-4 shrink-0"></i>เงินคืนพิเศษ (No Claim)</div>
                    </td>
                    ${[c1, c2, c3].map(c => `<td class="p-3 text-center text-emerald-700 font-bold">${c.ncb === "ไม่มี" ? '<span class="text-gray-400 font-normal">ไม่มี</span>' : c.ncb}</td>`).join('')}
                </tr>
            `;
            
            // Death
             html += `
                <tr class="bg-slate-800 text-white border-t-2 border-slate-600">
                    <td class="p-3 pl-4 md:pl-6 sticky left-0 bg-slate-800 border-r border-slate-700 font-medium shadow-[4px_0_8px_-4px_rgba(0,0,0,0.1)]">
                       กรณีเสียชีวิต
                       <div class="text-xs text-slate-400 font-light">ทุนประกันชีวิตหลัก</div>
                    </td>
                    ${[c1, c2, c3].map(c => `<td class="p-3 text-center font-bold text-lg">${c.death}</td>`).join('')}
                </tr>
            `;

            // Section 4 Limits
            html += createSectionHeader("4. เงื่อนไขการจำกัดวงเงิน");
            html += createRowHtml("วงเงินต่อการรักษา", null, "limit_confinement");
            html += `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="p-3 pl-4 md:pl-6 sticky left-0 bg-white border-r border-gray-200 font-medium text-gray-700 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]">
                        วงเงินสูงสุดต่อปี
                    </td>
                    ${[c1, c2, c3].map(c => `<td class="p-3 text-center text-sm font-bold text-gray-800">${c.limit_annual}</td>`).join('')}
                </tr>
            `;

            tbody.innerHTML = html;
        }

        function renderAll() {
            renderHeader('col1');
            renderHeader('col2');
            renderHeader('col3');
            
            // Sync mobile dropdowns
            renderDropdown('col1', state.col1.type, state.col1.index, true);
            renderDropdown('col2', state.col2.type, state.col2.index, true);
            
            renderBody();
            lucide.createIcons();
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            renderAll();
        });

    </script>
</body>
</html>

