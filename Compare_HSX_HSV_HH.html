<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AIA Premium Quotation Dashboard 2025</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --gold:#fbbf24;
      --gold2:#f59e0b;
    }

    body{
      font-family:'Sarabun',sans-serif;
      background:
        radial-gradient(1200px 800px at 20% 0%, rgba(251,191,36,0.08), transparent 60%),
        radial-gradient(1000px 800px at 80% 20%, rgba(20,184,166,0.10), transparent 55%),
        linear-gradient(180deg, #050a14 0%, #0b1220 100%);
    }

    .sticky-header{ position: sticky; top: 0; z-index: 50; }
    .sticky-col{
      position: sticky; left: 0; z-index: 20;
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(10px);
    }

    .fade-in { animation: fadeIn 0.35s ease-out; }
    @keyframes fadeIn { from { opacity:0; transform: translateY(5px);} to {opacity:1; transform: translateY(0);} }

    tr:hover td{ background-color: rgba(251,191,36,0.10); transition: 0.12s; }

    .premium-number{
      letter-spacing:-0.02em;
      text-shadow: 0 8px 24px rgba(251,191,36,0.22);
    }

    .cta-btn{
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold2) 100%);
      box-shadow: 0 14px 30px rgba(245,158,11,0.25), 0 6px 18px rgba(0,0,0,0.25);
    }
    .cta-btn:hover{ filter: brightness(1.05); transform: translateY(-1px); }

    /* PRINT QUOTATION */
    @media print {
      body { background: white !important; }
      #validator-panel, .sticky-header { display:none !important; }
      #quote-modal { position: static !important; inset: auto !important; display:block !important; }
      #quote-modal > div:first-child { display:none !important; } /* overlay hidden */
      #quote-modal .relative { width: 100% !important; margin: 0 !important; }
      #quote-modal .shadow-2xl { box-shadow: none !important; }
      #quote-modal button { display:none !important; }
    }
  </style>
</head>

<body class="text-slate-800">

  <div class="max-w-[1600px] mx-auto bg-white shadow-2xl min-h-screen flex flex-col border-x border-white/10">

    <!-- HEADER -->
    <div class="bg-gradient-to-r from-[#050a14] via-[#0b1220] to-[#0f1b2d] text-white p-5 sticky-header shadow-2xl border-b border-white/10">
      <div class="flex flex-col lg:flex-row justify-between items-center gap-4">

        <div class="flex items-center gap-3">
          <div class="bg-gradient-to-br from-[#fbbf24] to-[#f59e0b] p-2 rounded-xl shadow-xl">
            <i data-lucide="file-text" class="w-8 h-8 text-white"></i>
          </div>
          <div>
            <h1 class="text-xl font-extrabold tracking-tight">AIA Premium Quotation Dashboard (2025)</h1>
            <p class="text-xs text-white/70">
              ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á PDF: 07Rider_Feb2025 (‡∏´‡∏ô‡πâ‡∏≤ 3, 6, 9) + ‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡∏ñ‡∏∂‡∏á 98 ‡∏õ‡∏µ
            </p>
          </div>
        </div>

        <!-- Input Controls -->
        <div class="flex flex-wrap items-end gap-3 bg-white/10 p-2 rounded-xl border border-white/10 backdrop-blur">
          <div>
            <label class="block text-[10px] text-amber-200 mb-1 font-extrabold uppercase tracking-wider">‡πÄ‡∏û‡∏®</label>
            <select id="input-gender" onchange="app.reCalculate()"
              class="bg-black/30 border border-white/10 text-white text-sm rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-amber-400 outline-none w-24 shadow-sm">
              <option value="male">‡∏ä‡∏≤‡∏¢</option>
              <option value="female">‡∏´‡∏ç‡∏¥‡∏á</option>
            </select>
          </div>

          <div>
            <label class="block text-[10px] text-amber-200 mb-1 font-extrabold uppercase tracking-wider">‡∏≠‡∏≤‡∏¢‡∏∏</label>
            <input type="number" id="input-age" value="35" min="0" max="98" onchange="app.reCalculate()"
              class="bg-black/30 border border-white/10 text-white text-sm rounded-lg px-3 py-1.5 w-20 text-center focus:ring-2 focus:ring-amber-400 outline-none shadow-sm">
          </div>

          <button onclick="app.reCalculate()" class="cta-btn text-[#111827] text-sm font-extrabold py-1.5 px-4 rounded-xl transition-transform active:scale-95 flex items-center gap-2">
            <i data-lucide="sparkles" class="w-4 h-4"></i>
            <span>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</span>
          </button>

          <!-- Font Size Controls -->
          <div class="flex items-center gap-1 ml-1">
            <button onclick="app.setFontScale(-1)"
              class="px-2 py-1 rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 text-white text-xs font-extrabold"
              title="‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£">A-</button>

            <button onclick="app.setFontScale(0)"
              class="px-2 py-1 rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 text-white text-xs font-extrabold"
              title="‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£">A</button>

            <button onclick="app.setFontScale(1)"
              class="px-2 py-1 rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 text-white text-xs font-extrabold"
              title="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£">A+</button>
          </div>
        </div>
      </div>
    </div>

    <!-- PLAN SELECTION -->
    <div class="grid grid-cols-1 md:grid-cols-3 bg-white/70 backdrop-blur border-b border-white/30 sticky top-[84px] z-40 shadow-xl">
      <!-- Plan 1 -->
      <div class="p-3 border-r border-slate-200">
        <div class="flex justify-between mb-1">
          <span class="text-[10px] font-extrabold text-[#111827] bg-gradient-to-r from-[#fbbf24] to-[#f59e0b] px-2 py-0.5 rounded shadow">
            PLAN A (BEST VALUE)
          </span>
        </div>
        <select id="type-1" onchange="app.changeType(1, this.value)"
          class="w-full text-xs font-extrabold p-1.5 rounded-lg border border-slate-300 mb-1.5 bg-white text-slate-800"></select>
        <select id="idx-1" onchange="app.changeOption(1, this.value)"
          class="w-full text-xs p-1.5 rounded-lg border border-slate-300 bg-white text-slate-600"></select>
      </div>

      <!-- Plan 2 -->
      <div class="p-3 border-r border-slate-200">
        <div class="flex justify-between mb-1">
          <span class="text-[10px] font-extrabold text-white bg-gradient-to-r from-[#14b8a6] to-[#0ea5e9] px-2 py-0.5 rounded shadow">
            PLAN B
          </span>
        </div>
        <select id="type-2" onchange="app.changeType(2, this.value)"
          class="w-full text-xs font-extrabold p-1.5 rounded-lg border border-slate-300 mb-1.5 bg-white text-slate-800"></select>
        <select id="idx-2" onchange="app.changeOption(2, this.value)"
          class="w-full text-xs p-1.5 rounded-lg border border-slate-300 bg-white text-slate-600"></select>
      </div>

      <!-- Plan 3 -->
      <div class="p-3">
        <div class="flex justify-between mb-1">
          <span class="text-[10px] font-extrabold text-white bg-gradient-to-r from-[#db2777] to-[#7c3aed] px-2 py-0.5 rounded shadow">
            PLAN C (MAX)
          </span>
        </div>
        <select id="type-3" onchange="app.changeType(3, this.value)"
          class="w-full text-xs font-extrabold p-1.5 rounded-lg border border-slate-300 mb-1.5 bg-white text-slate-800"></select>
        <select id="idx-3" onchange="app.changeOption(3, this.value)"
          class="w-full text-xs p-1.5 rounded-lg border border-slate-300 bg-white text-slate-600"></select>
      </div>
    </div>

    <!-- Decision Bar -->
    <div class="px-4 md:px-8 py-3 bg-gradient-to-r from-amber-50 via-white to-emerald-50 border-b border-amber-100">
      <div class="flex flex-col md:flex-row gap-3 md:items-center md:justify-between">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-amber-400 to-amber-600 text-white flex items-center justify-center shadow">
            <i data-lucide="award" class="w-5 h-5"></i>
          </div>
          <div>
            <div class="text-sm font-extrabold text-slate-900">
              ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏¢‡∏∏‡∏ô‡∏µ‡πâ: <span id="best-plan-name" class="text-amber-700">-</span>
            </div>
            <div class="text-xs text-slate-600">
              ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏û‡∏á‡∏™‡∏∏‡∏î <span id="best-plan-save" class="font-bold text-emerald-700">-</span> ‡∏ï‡πà‡∏≠‡∏õ‡∏µ ¬∑ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö ‚Äú‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‚Äù
            </div>
          </div>
        </div>

        <div class="flex items-center gap-2">
          <div class="text-xs text-slate-500 hidden md:block">
            ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ú‡∏ô‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡∏î)
          </div>
          <div id="delta-chips" class="flex flex-wrap gap-2"></div>
        </div>
      </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="flex-grow bg-white">

      <!-- 1. Current Premium & Coverage Table -->
      <div class="overflow-x-auto">
        <table class="w-full min-w-[1000px] border-collapse text-sm">
          <thead>

            <tr class="bg-gradient-to-r from-[#071226] to-[#0b1627] border-b border-white/10">
              <th class="p-4 text-left sticky-col bg-white border-r border-slate-200 z-10 w-[25%]">
                <div class="flex items-center gap-2 text-slate-900 font-extrabold text-base">
                  <i data-lucide="coins" class="w-5 h-5 text-amber-600"></i> ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                </div>
                <div class="text-[10px] font-normal text-slate-500 mt-1 pl-7">‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î)</div>
              </th>

              <th id="prem-1" class="p-4 text-center text-3xl font-extrabold text-[#fbbf24] premium-number w-[25%] border-r border-white/10 tracking-tight">-</th>
              <th id="prem-2" class="p-4 text-center text-3xl font-extrabold text-[#fbbf24] premium-number w-[25%] border-r border-white/10 tracking-tight">-</th>
              <th id="prem-3" class="p-4 text-center text-3xl font-extrabold text-[#fbbf24] premium-number w-[25%] tracking-tight">-</th>
            </tr>

            <tr class="bg-white border-b-4 border-slate-100">
              <th class="p-4 text-left sticky-col bg-white border-r border-slate-200 z-10 align-top">
                <span class="text-lg font-extrabold text-slate-900">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á</span>
              </th>
              <th id="head-1" class="p-4 align-top transition-colors border-r border-slate-100"></th>
              <th id="head-2" class="p-4 align-top transition-colors border-r border-slate-100"></th>
              <th id="head-3" class="p-4 align-top transition-colors"></th>
            </tr>
          </thead>

          <tbody id="table-body" class="divide-y divide-slate-100 text-slate-700"></tbody>
        </table>
      </div>

      <!-- 2. Premium Projection Table -->
      <div class="mt-8 mb-10 mx-4 md:mx-8 border border-slate-200 rounded-2xl overflow-hidden shadow-xl bg-white">
        <div class="bg-gradient-to-r from-[#050a14] to-[#0f1b2d] text-white p-4 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <i data-lucide="trending-up" class="w-5 h-5 text-amber-400"></i>
            <h2 class="text-lg font-extrabold">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏†‡∏±‡∏¢ (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)</h2>
          </div>
          <span class="text-xs text-white/70 bg-white/10 px-2 py-1 rounded-lg border border-white/10">‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ñ‡∏∂‡∏á 98 ‡∏õ‡∏µ</span>
        </div>

        <div class="overflow-x-auto">
          <table class="w-full text-sm text-center">
            <thead class="bg-slate-100 text-slate-600 font-extrabold border-b border-slate-200">
              <tr>
                <th class="p-3 w-[15%]">‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)</th>
                <th class="p-3 w-[28%]" id="proj-head-1">PLAN A</th>
                <th class="p-3 w-[28%]" id="proj-head-2">PLAN B</th>
                <th class="p-3 w-[28%]" id="proj-head-3">PLAN C</th>
              </tr>
            </thead>
            <tbody id="premium-table-body" class="divide-y divide-slate-100"></tbody>
          </table>
        </div>

        <div class="p-3 bg-gradient-to-r from-white to-amber-50 text-[11px] text-slate-700 text-center border-t border-amber-200">
          ‚ö° ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‚Äú‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‚Äù ‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°
          <span class="text-amber-700 font-extrabold">(* ‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ * ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏)</span>
        </div>
      </div>
    </div>

    <!-- FOOTER -->
    <div class="bg-white/80 p-6 border-t border-slate-200 text-xs text-slate-500">
      <div class="max-w-6xl mx-auto">
        <strong class="text-slate-700 block mb-2">üìå ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô:</strong>
        <ul class="list-disc ml-4 space-y-1">
          <li><strong>AIA H&S Extra:</strong> ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å PDF ‡∏´‡∏ô‡πâ‡∏≤ 3</li>
          <li><strong>AIA Health Saver:</strong> ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å PDF ‡∏´‡∏ô‡πâ‡∏≤ 6</li>
          <li><strong>AIA Health Happy:</strong> ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å PDF ‡∏´‡∏ô‡πâ‡∏≤ 9</li>
          <li>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏õ‡∏µ‡∏ï‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ (Age Band) ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏´‡∏•‡∏±‡∏Å ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÉ‡∏î‡πÜ</li>
          <li>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡∏ñ‡∏∂‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ 98 ‡∏õ‡∏µ ‡∏ï‡∏≤‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô PDF (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô 76-80*, 81-85* ‚Ä¶ 96-98*)</li>
        </ul>
      </div>
    </div>
  </div>


  <!-- Rate Table Validator Panel -->
  <div id="validator-panel" class="fixed bottom-4 right-4 z-[9999] hidden max-w-md">
    <div class="bg-red-600 text-white rounded-xl shadow-2xl border border-red-200 overflow-hidden">
      <div class="px-4 py-3 font-extrabold text-sm flex items-center justify-between">
        <span>‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö</span>
        <button onclick="document.getElementById('validator-panel').classList.add('hidden')" class="text-white/90 hover:text-white font-extrabold">‚úï</button>
      </div>
      <div id="validator-body" class="px-4 py-3 text-xs bg-white text-slate-800 max-h-64 overflow-auto"></div>
      <div class="px-4 py-2 bg-red-50 text-[10px] text-red-700 border-t border-red-100">
        * ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ñ‡∏π‡∏Å log ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô Console (F12)
      </div>
    </div>
  </div>


  <!-- QUOTATION MODAL (Close Deal) -->
  <div id="quote-modal" class="fixed inset-0 z-[99999] hidden">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="app.closeQuote()"></div>

    <div class="relative mx-auto my-6 w-[95%] md:w-[900px] max-w-[980px]">
      <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-slate-200">

        <div class="px-5 py-4 bg-gradient-to-r from-[#050a14] via-[#0b1220] to-[#0f1b2d] text-white">
          <div class="flex items-start justify-between gap-3">
            <div class="flex items-start gap-3">
              <div class="w-11 h-11 rounded-xl bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center shadow">
                <i data-lucide="file-check" class="w-6 h-6 text-white"></i>
              </div>
              <div>
                <div class="text-base font-extrabold">‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô (Quotation)</div>
                <div class="text-xs text-white/70" id="quote-subtitle">-</div>
              </div>
            </div>

            <button onclick="app.closeQuote()"
              class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20 border border-white/10 text-white text-sm font-extrabold">
              ‡∏õ‡∏¥‡∏î ‚úï
            </button>
          </div>
        </div>

        <div class="p-5 md:p-6">
          <!-- Summary -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
            <div class="rounded-2xl border border-slate-200 p-4">
              <div class="text-xs text-slate-500">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
              <div class="text-lg font-extrabold text-slate-900" id="quote-plan">-</div>
              <div class="text-sm font-extrabold text-slate-600" id="quote-option">-</div>
            </div>

            <div class="rounded-2xl border border-amber-200 bg-gradient-to-br from-amber-50 to-white p-4">
              <div class="text-xs text-amber-700 font-extrabold">‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
              <div class="text-3xl font-extrabold text-amber-700 tracking-tight" id="quote-premium">-</div>
              <div class="text-[11px] text-slate-600">* ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏´‡∏•‡∏±‡∏Å / ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏±‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</div>
            </div>

            <div class="rounded-2xl border border-emerald-200 bg-gradient-to-br from-emerald-50 to-white p-4">
              <div class="text-xs text-emerald-700 font-extrabold">‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô / ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö</div>
              <div class="text-sm font-extrabold text-slate-900 mt-1" id="quote-highlight">-</div>
              <div class="text-[11px] text-slate-600 mt-1" id="quote-urgency">
                ‚ö° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‚Äú‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‚Äù ‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°
              </div>
            </div>
          </div>

          <!-- Comparison -->
          <div class="mt-5 rounded-2xl border border-slate-200 overflow-hidden">
            <div class="px-4 py-3 bg-slate-50 border-b border-slate-200 flex items-center justify-between">
              <div class="font-extrabold text-slate-800 text-sm">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÅ‡∏ú‡∏ô (‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)</div>
              <div class="text-xs text-slate-500" id="quote-compare-note">-</div>
            </div>

            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <thead class="bg-white border-b border-slate-200 text-slate-600">
                  <tr>
                    <th class="text-left p-3 w-[25%]">‡πÅ‡∏ú‡∏ô</th>
                    <th class="text-left p-3 w-[25%]">‡∏™‡∏±‡∏ç‡∏ç‡∏≤</th>
                    <th class="text-right p-3 w-[25%]">‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡∏õ‡∏µ</th>
                    <th class="text-right p-3 w-[25%]">‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏ú‡∏ô‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡∏î</th>
                  </tr>
                </thead>
                <tbody id="quote-compare-body" class="divide-y divide-slate-100"></tbody>
              </table>
            </div>
          </div>

          <!-- SALES PRO MODE -->
          <div class="mt-5 rounded-2xl border border-slate-200 overflow-hidden">
            <div class="px-4 py-3 bg-slate-50 border-b border-slate-200 flex items-center justify-between">
              <div class="font-extrabold text-slate-800 text-sm flex items-center gap-2">
                <i data-lucide="contact" class="w-4 h-4 text-slate-600"></i>
                ‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)
              </div>
              <div class="text-xs text-slate-500">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ</div>
            </div>

            <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-3 bg-white">
              <div>
                <label class="text-xs font-bold text-slate-600">‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
                <input id="cust-name" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ"
                  class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-amber-400" />
              </div>

              <div>
                <label class="text-xs font-bold text-slate-600">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
                <input id="cust-phone" type="tel" placeholder="0xxxxxxxxx"
                  class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-amber-400" />
              </div>

              <div>
                <label class="text-xs font-bold text-slate-600">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á</label>
                <select id="cust-channel"
                  class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-amber-400">
                  <option value="LINE">LINE</option>
                  <option value="Facebook">Facebook</option>
                  <option value="‡πÇ‡∏ó‡∏£">‡πÇ‡∏ó‡∏£</option>
                  <option value="Walk-in">Walk-in</option>
                </select>
              </div>

              <div>
                <label class="text-xs font-bold text-slate-600">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                <input id="cust-note" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ô‡πâ‡∏ô IPD / ‡∏á‡∏ö 2 ‡∏´‡∏°‡∏∑‡πà‡∏ô"
                  class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-amber-400" />
              </div>

              <div class="md:col-span-2 flex flex-wrap gap-2 pt-1">
                <button onclick="app.saveQuoteToHistory()"
                  class="px-4 py-2 rounded-xl bg-emerald-600 text-white font-extrabold text-sm hover:brightness-105 active:scale-[0.99] transition flex items-center gap-2">
                  <i data-lucide="save" class="w-4 h-4"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤
                </button>

                <button onclick="app.toggleHistory()"
                  class="px-4 py-2 rounded-xl bg-white border border-slate-300 text-slate-900 font-extrabold text-sm hover:bg-slate-50 active:scale-[0.99] transition flex items-center gap-2">
                  <i data-lucide="folder-open" class="w-4 h-4"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠
                </button>

                <button onclick="app.clearHistory()"
                  class="px-4 py-2 rounded-xl bg-white border border-red-300 text-red-600 font-extrabold text-sm hover:bg-red-50 active:scale-[0.99] transition flex items-center gap-2">
                  <i data-lucide="trash-2" class="w-4 h-4"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
              </div>
            </div>

            <div id="history-panel" class="hidden border-t border-slate-200 bg-slate-50">
              <div class="px-4 py-2 text-xs font-extrabold text-slate-600">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</div>
              <div id="history-list" class="px-4 pb-4 space-y-2"></div>
            </div>
          </div>

          <!-- Actions -->
          <div class="mt-5 flex flex-col md:flex-row gap-2 md:items-center md:justify-between">
            <div class="flex flex-wrap gap-2">
              <button onclick="app.copyQuoteText()"
                class="px-4 py-2 rounded-xl bg-slate-900 text-white font-extrabold text-sm hover:brightness-105 active:scale-[0.99] transition flex items-center gap-2">
                <i data-lucide="copy" class="w-4 h-4"></i> Copy ‡∏™‡πà‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
              </button>

              <button onclick="app.exportQuotePDF()"
                class="px-4 py-2 rounded-xl bg-white border border-slate-300 text-slate-900 font-extrabold text-sm hover:bg-slate-50 active:scale-[0.99] transition flex items-center gap-2">
                <i data-lucide="printer" class="w-4 h-4"></i> Export PDF
              </button>
            </div>

            <button onclick="app.confirmPlan()"
              class="px-5 py-2.5 rounded-xl font-extrabold text-sm text-[#111827]
                     bg-gradient-to-r from-[#fbbf24] to-[#f59e0b]
                     shadow-lg hover:brightness-105 active:scale-[0.99] transition flex items-center gap-2 justify-center">
              <i data-lucide="badge-check" class="w-4 h-4"></i> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏ú‡∏ô‡∏ô‡∏µ‡πâ (‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢)
            </button>
          </div>

          <div class="mt-3 text-[10px] text-slate-500">
            ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ AIA Rider: H&S Extra (‡∏´‡∏ô‡πâ‡∏≤ 3), Health Saver (‡∏´‡∏ô‡πâ‡∏≤ 6), Health Happy (‡∏´‡∏ô‡πâ‡∏≤ 9)
          </div>
        </div>

      </div>
    </div>
  </div>


  <script>
    const app = {
      // ---------------------------
      // UI STATE
      // ---------------------------
      ui: {
        fontScaleIndex: 1,
        fontScales: [0.92, 1.0, 1.08]
      },

      quoteState: {
        selectedCol: null,
        age: null,
        gender: null,
        ageIdx: null
      },

      setFontScale: function(mode) {
        if (mode === 0) this.ui.fontScaleIndex = 1;
        else this.ui.fontScaleIndex = Math.max(0, Math.min(2, this.ui.fontScaleIndex + mode));
        const scale = this.ui.fontScales[this.ui.fontScaleIndex];
        document.documentElement.style.fontSize = (16 * scale) + "px";
      },

      formatMoney: function(n) {
        return (n || 0).toLocaleString();
      },

      // ---------------------------
      // SALES PRO MODE (LOCAL STORAGE)
      // ---------------------------
      storageKey: "AIA_QUOTE_HISTORY_V1",

      getCustomerData: function() {
        return {
          name: (document.getElementById("cust-name")?.value || "").trim(),
          phone: (document.getElementById("cust-phone")?.value || "").trim(),
          channel: document.getElementById("cust-channel")?.value || "LINE",
          note: (document.getElementById("cust-note")?.value || "").trim(),
        };
      },

      loadHistory: function() {
        try {
          const raw = localStorage.getItem(this.storageKey);
          return raw ? JSON.parse(raw) : [];
        } catch (e) {
          console.warn("loadHistory error", e);
          return [];
        }
      },

      writeHistory: function(arr) {
        localStorage.setItem(this.storageKey, JSON.stringify(arr));
      },

      toggleHistory: function() {
        const panel = document.getElementById("history-panel");
        if (!panel) return;
        panel.classList.toggle("hidden");
        this.renderHistory();
        lucide.createIcons();
      },

      renderHistory: function() {
        const list = document.getElementById("history-list");
        if (!list) return;

        const history = this.loadHistory();
        if (history.length === 0) {
          list.innerHTML = `<div class="text-xs text-slate-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</div>`;
          return;
        }

        list.innerHTML = history.slice().reverse().map((h, idxRev) => {
          const idx = history.length - 1 - idxRev;
          return `
            <div class="bg-white rounded-xl border border-slate-200 p-3">
              <div class="flex items-start justify-between gap-2">
                <div>
                  <div class="text-sm font-extrabold text-slate-900">
                    ${h.customer?.name || "(‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠)"}
                    <span class="text-xs text-slate-500 font-bold">¬∑ ${h.customer?.phone || "-"}</span>
                  </div>
                  <div class="text-xs text-slate-600">
                    PLAN ${h.selectedCol} ¬∑ ${h.planName} ‚Äî ${h.optionName}
                  </div>
                  <div class="text-xs font-extrabold text-amber-700 mt-1">
                    ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢: ${this.formatMoney(h.premium)} ‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ
                  </div>
                  <div class="text-[11px] text-slate-500 mt-1">
                    ‡∏≠‡∏≤‡∏¢‡∏∏ ${h.age} ¬∑ ${h.gender === "male" ? "‡∏ä‡∏≤‡∏¢" : "‡∏´‡∏ç‡∏¥‡∏á"} ¬∑ ${h.customer?.channel || "-"} ¬∑ ${h.createdAt}
                  </div>
                  ${h.customer?.note ? `<div class="text-[11px] text-slate-600 mt-1">‡πÇ‡∏ô‡πâ‡∏ï: ${h.customer.note}</div>` : ""}
                </div>

                <div class="flex flex-col gap-2">
                  <button onclick="app.loadHistoryItem(${idx})"
                    class="px-3 py-1.5 rounded-lg bg-slate-900 text-white text-xs font-extrabold hover:brightness-105">
                    ‡πÇ‡∏´‡∏•‡∏î
                  </button>
                  <button onclick="app.deleteHistoryItem(${idx})"
                    class="px-3 py-1.5 rounded-lg bg-white border border-red-300 text-red-600 text-xs font-extrabold hover:bg-red-50">
                    ‡∏•‡∏ö
                  </button>
                </div>
              </div>
            </div>
          `;
        }).join("");
      },

      saveQuoteToHistory: function() {
        const col = this.quoteState.selectedCol ?? 1;
        const gender = this.quoteState.gender ?? document.getElementById('input-gender').value;
        const age = this.quoteState.age ?? parseInt(document.getElementById('input-age').value);
        const ageIdx = this.quoteState.ageIdx ?? this.getAgeIndex(age);

        const { type, idx } = this.state[col];
        const planName = this.plans[type].name;
        const optionName = this.plans[type].options[idx].name;
        const premium = this.calculatePremium(type, idx, ageIdx, gender);
        const customer = this.getCustomerData();

        const record = {
          id: (crypto && crypto.randomUUID) ? crypto.randomUUID() : String(Date.now()),
          createdAt: new Date().toLocaleString('th-TH'),
          selectedCol: col,
          gender,
          age,
          planType: type,
          planIdx: idx,
          planName,
          optionName,
          premium,
          customer,
        };

        const history = this.loadHistory();
        history.push(record);
        this.writeHistory(history);

        alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
        this.renderHistory();
        lucide.createIcons();
      },

      loadHistoryItem: function(index) {
        const history = this.loadHistory();
        const item = history[index];
        if (!item) return;

        document.getElementById("input-gender").value = item.gender;
        document.getElementById("input-age").value = item.age;

        const col = item.selectedCol;
        this.state[col].type = item.planType;
        this.state[col].idx = item.planIdx;

        document.getElementById("cust-name").value = item.customer?.name || "";
        document.getElementById("cust-phone").value = item.customer?.phone || "";
        document.getElementById("cust-channel").value = item.customer?.channel || "LINE";
        document.getElementById("cust-note").value = item.customer?.note || "";

        [1,2,3].forEach(c => {
          this.renderSelectors(c);
          this.updateHeader(c);
        });

        this.renderBody();
        this.reCalculate();
        this.openQuote(col);
      },

      deleteHistoryItem: function(index) {
        const history = this.loadHistory();
        if (!history[index]) return;
        history.splice(index, 1);
        this.writeHistory(history);
        this.renderHistory();
        lucide.createIcons();
      },

      clearHistory: function() {
        if (!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) return;
        localStorage.removeItem(this.storageKey);
        this.renderHistory();
        lucide.createIcons();
      },

      // ---------------------------
      // PLAN META
      // ---------------------------
      plans: {
        HSX: {
          name: "AIA H&S Extra (New)", subtitle: "‡πÅ‡∏¢‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏´‡∏°‡∏ß‡∏î", theme: "emerald", bg: "bg-emerald-50", border: "border-emerald-400",
          options: [
            { name: "‡πÅ‡∏ú‡∏ô 1500", limit: "‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î", cat1: "1,500", cat2: "20,000", cat3: "60,000", cat4: "800", cat5: "60,000", cat6: "4,000", cat9: "10,000", cat10: "10,000", cat11: "2,000", opd: "3,000", ncb: "1,500", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 2000", limit: "‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î", cat1: "2,000", cat2: "20,000", cat3: "80,000", cat4: "800", cat5: "80,000", cat6: "5,000", cat9: "15,000", cat10: "15,000", cat11: "2,000", opd: "4,000", ncb: "2,000", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 2500", limit: "‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î", cat1: "2,500", cat2: "25,000", cat3: "100,000", cat4: "1,000", cat5: "100,000", cat6: "7,500", cat9: "20,000", cat10: "20,000", cat11: "3,000", opd: "5,000", ncb: "2,500", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 3500", limit: "‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î", cat1: "3,500", cat2: "35,000", cat3: "120,000", cat4: "1,200", cat5: "120,000", cat6: "10,000", cat9: "25,000", cat10: "25,000", cat11: "4,000", opd: "7,000", ncb: "3,500", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 4500", limit: "‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î", cat1: "4,500", cat2: "40,000", cat3: "130,000", cat4: "1,500", cat5: "130,000", cat6: "12,500", cat9: "30,000", cat10: "30,000", cat11: "5,000", opd: "8,000", ncb: "3,500", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 5500", limit: "‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î", cat1: "5,500", cat2: "45,000", cat3: "140,000", cat4: "2,000", cat5: "140,000", cat6: "15,000", cat9: "30,000", cat10: "30,000", cat11: "5,000", opd: "9,000", ncb: "4,000", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 6500", limit: "‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î", cat1: "6,500", cat2: "50,000", cat3: "150,000", cat4: "2,500", cat5: "150,000", cat6: "17,500", cat9: "30,000", cat10: "30,000", cat11: "5,000", opd: "10,000", ncb: "4,000", death: "10,000" }
          ]
        },
        HSV: {
          name: "AIA Health Saver", subtitle: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô", theme: "blue", bg: "bg-sky-50", border: "border-sky-400",
          options: [
            { name: "‡πÅ‡∏ú‡∏ô 200k", limit: "2 ‡πÅ‡∏™‡∏ô", cat1: "1,500", cat2: "2‡πÅ‡∏™‡∏ô", cat3: "‡∏£‡πà‡∏ß‡∏°", cat4: "800", cat5: "‡∏£‡πà‡∏ß‡∏°", cat6: "‡∏£‡πà‡∏ß‡∏°", cat9: "10,000", cat10: "10,000", cat11: "3,000", opd: "-", ncb: "-", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 300k", limit: "3 ‡πÅ‡∏™‡∏ô", cat1: "2,000", cat2: "3‡πÅ‡∏™‡∏ô", cat3: "‡∏£‡πà‡∏ß‡∏°", cat4: "1,000", cat5: "‡∏£‡πà‡∏ß‡∏°", cat6: "‡∏£‡πà‡∏ß‡∏°", cat9: "15,000", cat10: "15,000", cat11: "3,000", opd: "-", ncb: "-", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 400k", limit: "4 ‡πÅ‡∏™‡∏ô", cat1: "3,000", cat2: "4‡πÅ‡∏™‡∏ô", cat3: "‡∏£‡πà‡∏ß‡∏°", cat4: "1,200", cat5: "‡∏£‡πà‡∏ß‡∏°", cat6: "‡∏£‡πà‡∏ß‡∏°", cat9: "20,000", cat10: "20,000", cat11: "4,000", opd: "1,000", ncb: "-", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 500k", limit: "5 ‡πÅ‡∏™‡∏ô", cat1: "4,000", cat2: "5‡πÅ‡∏™‡∏ô", cat3: "‡∏£‡πà‡∏ß‡∏°", cat4: "1,500", cat5: "‡∏£‡πà‡∏ß‡∏°", cat6: "‡∏£‡πà‡∏ß‡∏°", cat9: "25,000", cat10: "25,000", cat11: "5,000", opd: "1,500", ncb: "-", death: "10,000" }
          ]
        },
        HH: {
          name: "AIA Health Happy", subtitle: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏π‡∏á", theme: "pink", bg: "bg-pink-50", border: "border-pink-400",
          options: [
            { name: "‡πÅ‡∏ú‡∏ô 1 ‡∏•‡πâ‡∏≤‡∏ô", limit: "1 ‡∏•‡πâ‡∏≤‡∏ô", cat1: "1,500", cat2: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat3: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat4: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat5: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat6: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat9: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat10: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat11: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", opd: "-", ncb: "-", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 5 ‡∏•‡πâ‡∏≤‡∏ô", limit: "5 ‡∏•‡πâ‡∏≤‡∏ô", cat1: "3,000", cat2: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat3: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat4: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat5: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat6: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat9: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat10: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat11: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", opd: "-", ncb: "-", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 15 ‡∏•‡πâ‡∏≤‡∏ô", limit: "15 ‡∏•‡πâ‡∏≤‡∏ô", cat1: "6,000", cat2: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat3: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat4: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat5: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat6: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat9: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat10: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat11: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", opd: "-", ncb: "-", death: "10,000" },
            { name: "‡πÅ‡∏ú‡∏ô 25 ‡∏•‡πâ‡∏≤‡∏ô", limit: "25 ‡∏•‡πâ‡∏≤‡∏ô", cat1: "9,000", cat2: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat3: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat4: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat5: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat6: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat9: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat10: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", cat11: "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢", opd: "2,000", ncb: "-", death: "10,000" }
          ]
        }
      },

      ageBands: [
        "11-15", "16-20", "21-25", "26-30", "31-35",
        "36-40", "41-45", "46-50", "51-55",
        "56-59", "60-65",
        "66-70", "71-75",
        "76-80*", "81-85*", "86-90*", "91-95*", "96-98*"
      ],

      // ---------------------------
      // RATE TABLE (‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡πÑ‡∏ß‡πâ)
      // ---------------------------
      rateTable: {
        HSX: { male: {}, female: {} },
        HSV: { male: {}, female: {} },
        HH:  { male: {}, female: {} }
      },

      state: {
        1: { type: 'HSX', idx: 2 },
        2: { type: 'HSV', idx: 2 },
        3: { type: 'HH', idx: 1 }
      },

      // ---------------------------
      // VALIDATOR
      // ---------------------------
      getExpectedPlanCount: function(type) {
        if (type === "HSX") return 7;
        if (type === "HSV") return 4;
        if (type === "HH")  return 4;
        return 0;
      },

      showValidatorPanel: function(errors) {
        const panel = document.getElementById("validator-panel");
        const body = document.getElementById("validator-body");
        if (!panel || !body) return;
        panel.classList.remove("hidden");
        body.innerHTML = errors.map(e => `<div class="mb-1">‚Ä¢ ${e}</div>`).join("");
      },

      validateRateTable: function() {
        const errors = [];
        const types = Object.keys(this.plans);
        const genders = ["male", "female"];

        types.forEach(type => {
          const expectedPlanCount = this.getExpectedPlanCount(type);

          genders.forEach(g => {
            const t = this.rateTable?.[type]?.[g];
            if (!t) {
              errors.push(`[${type}/${g}] ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô rateTable`);
              return;
            }

            for (let bandIndex = 0; bandIndex < this.ageBands.length; bandIndex++) {
              const row = t[bandIndex];

              if (!row) {
                errors.push(`[${type}/${g}] ‡∏Ç‡∏≤‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ index=${bandIndex} (${this.ageBands[bandIndex]})`);
                continue;
              }

              if (!Array.isArray(row)) {
                errors.push(`[${type}/${g}] ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÅ‡∏ñ‡∏ß‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á index=${bandIndex} (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Array)`);
                continue;
              }

              if (row.length !== expectedPlanCount) {
                errors.push(`[${type}/${g}] ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ú‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á index=${bandIndex} (${this.ageBands[bandIndex]}): ‡∏û‡∏ö ${row.length} ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡πá‡∏ô ${expectedPlanCount}`);
                continue;
              }

              row.forEach((val, planIdx) => {
                if (val === null || val === undefined || Number.isNaN(Number(val))) {
                  errors.push(`[${type}/${g}] ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ú‡∏¥‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: band=${this.ageBands[bandIndex]}, planIdx=${planIdx} = ${val}`);
                } else if (Number(val) <= 0) {
                  errors.push(`[${type}/${g}] ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏õ‡πá‡∏ô 0/‡∏ï‡∏¥‡∏î‡∏•‡∏ö: band=${this.ageBands[bandIndex]}, planIdx=${planIdx} = ${val}`);
                }
              });
            }
          });
        });

        if (errors.length > 0) {
          console.group("‚ö†Ô∏è rateTable Validation Errors");
          errors.forEach(e => console.warn(e));
          console.groupEnd();
          this.showValidatorPanel(errors);
        } else {
          console.log("‚úÖ rateTable validation: OK (‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô/‡πÄ‡∏û‡∏®/‡∏ä‡πà‡∏ß‡∏á‡∏≠‡∏≤‡∏¢‡∏∏)");
        }

        return errors;
      },

      // ---------------------------
      // INIT + CALC
      // ---------------------------
      init: function() {
        // ‚úÖ Inject rate tables
        this.injectRateTables();

        this.validateRateTable();

        [1,2,3].forEach(col => {
          this.renderSelectors(col);
          this.updateHeader(col);
        });

        this.renderBody();
        this.reCalculate();
      },

      injectRateTables: function() {
        // --- HSX male/female ---
        this.rateTable.HSX.male = {
          0: [7370, 9380, 10600, 13280, 15900, 17420, 18730],
          1: [7280, 8630, 9880, 12150, 14750, 16500, 17930],
          2: [6820, 8320, 9770, 12050, 14680, 16460, 17910],
          3: [6920, 8520, 9850, 12920, 15630, 17700, 19210],
          4: [7060, 8900, 10270, 13040, 15680, 17690, 19280],
          5: [7330, 9200, 10780, 13070, 15720, 17850, 19270],
          6: [7780, 9710, 11550, 13800, 16550, 18290, 19860],
          7: [8540, 10530, 12470, 15620, 18860, 21060, 22660],
          8: [10890, 13680, 16800, 21580, 26530, 29750, 32010],
          9: [15270, 18830, 21820, 31900, 38650, 44240, 48190],
          10: [22410, 26510, 29820, 44080, 54090, 61730, 67360],
          11: [31530, 37460, 42550, 62140, 77250, 88020, 96040],
          12: [47040, 55280, 62490, 85460, 106810, 121700, 132630],
          13: [67730, 79600, 89980, 123060, 153800, 175250, 190980],
          14: [94820, 111430, 125970, 172280, 215320, 245340, 267370],
          15: [104300, 122570, 138570, 189510, 236850, 269870, 294110],
          16: [114730, 134830, 152430, 208460, 260540, 296860, 323520],
          17: [126200, 148310, 167670, 229310, 286590, 326550, 355870],
        };

        this.rateTable.HSX.female = {
          0: [7690, 9810, 11620, 15410, 18380, 20120, 21600],
          1: [7370, 9690, 11170, 15190, 18380, 19950, 21550],
          2: [8510, 10550, 12420, 16390, 20120, 22260, 24050],
          3: [9050, 11300, 12890, 17030, 20740, 23250, 24760],
          4: [9170, 11330, 13030, 17330, 21030, 23550, 25080],
          5: [9420, 11800, 14070, 17970, 21500, 23820, 25510],
          6: [10050, 12610, 15070, 19310, 23190, 25720, 27580],
          7: [11080, 13760, 16880, 22380, 27160, 30190, 32400],
          8: [13790, 16730, 20160, 26830, 32920, 36760, 39370],
          9: [17970, 21880, 25290, 34000, 42170, 48190, 51340],
          10: [23990, 28910, 34030, 46090, 57150, 67060, 71040],
          11: [33060, 39360, 45860, 62780, 77480, 96040, 96180],
          12: [47540, 56580, 64620, 86810, 108830, 132630, 134860],
          13: [68460, 81480, 93050, 125010, 156720, 178070, 194200],
          14: [95840, 114060, 130270, 175010, 219400, 249300, 271880],
          15: [105420, 125470, 143300, 192510, 241340, 274230, 299070],
          16: [115960, 138020, 157630, 211760, 265470, 301650, 328980],
          17: [127560, 151820, 173390, 232940, 292020, 331820, 361880],
        };

        // --- HSV male/female ---
        this.rateTable.HSV.male = {
          0: [10100, 12300, 16400, 20200],
          1: [7300, 8700, 10600, 13700],
          2: [6900, 8400, 10400, 13400],
          3: [7400, 8900, 13500, 16600],
          4: [7500, 9300, 14700, 18900],
          5: [8500, 10200, 15200, 20100],
          6: [10000, 11400, 17100, 21600],
          7: [11800, 13000, 18000, 24700],
          8: [15400, 17200, 24300, 30900],
          9: [20600, 24200, 30700, 40500],
          10: [27300, 31000, 47000, 56600],
          11: [37500, 47100, 65900, 81000],
          12: [53700, 67400, 94400, 115800],
          13: [76900, 96600, 135200, 165600],
          14: [110200, 138500, 193800, 236800],
          15: [121200, 152400, 222900, 272300],
          16: [133300, 167600, 256300, 313100],
          17: [146600, 184400, 294700, 360100],
        };

        this.rateTable.HSV.female = {
          0: [8500, 10500, 14400, 18200],
          1: [7400, 9700, 12000, 15000],
          2: [8600, 10600, 14400, 18100],
          3: [9100, 11300, 17100, 21000],
          4: [9200, 11700, 18000, 22700],
          5: [10400, 11900, 18500, 25100],
          6: [12100, 13800, 21700, 26500],
          7: [14300, 16000, 23200, 29200],
          8: [15500, 17200, 25600, 34100],
          9: [20800, 24400, 31000, 40900],
          10: [27600, 31300, 47500, 57200],
          11: [37900, 47600, 66600, 81800],
          12: [54200, 68100, 95300, 117000],
          13: [77700, 97600, 136600, 167300],
          14: [111300, 139900, 195700, 239200],
          15: [122400, 153900, 225100, 275100],
          16: [134600, 169300, 258900, 316400],
          17: [148100, 186200, 297700, 363900],
        };

        // --- HH male/female ---
        this.rateTable.HH.male = {
          0:  [16400, 20200, 25500, 33400],
          1:  [13500, 16500, 20100, 26200],
          2:  [13700, 16900, 21600, 28000],
          3:  [14700, 18300, 26100, 33800],
          4:  [15100, 18900, 29400, 37800],
          5:  [17000, 20800, 31800, 40900],
          6:  [19200, 23800, 36000, 47300],
          7:  [21600, 26700, 40200, 52400],
          8:  [28300, 35000, 50100, 65300],
          9:  [34100, 42300, 63900, 83000],
          10: [40900, 50600, 72300, 94100],
          11: [59400, 72100, 105000, 136700],
          12: [85400, 104000, 152100, 197800],
          13: [122900, 150000, 219900, 286300],
          14: [177800, 217100, 318300, 414700],
          15: [204500, 249700, 366000, 476900],
          16: [235200, 287200, 420900, 548400],
          17: [270500, 330300, 484200, 630700],
        };

        this.rateTable.HH.female = {
          0:  [14400, 18200, 21600, 27900],
          1:  [15200, 19100, 23100, 30300],
          2:  [17200, 21500, 27000, 35300],
          3:  [17500, 21800, 30600, 38000],
          4:  [18400, 22700, 34200, 42300],
          5:  [20400, 25100, 37200, 46000],
          6:  [22300, 27800, 42900, 53600],
          7:  [24500, 30400, 46500, 60700],
          8:  [28500, 35200, 50700, 65500],
          9:  [34400, 42500, 65100, 84600],
          10: [41500, 50800, 73500, 95700],
          11: [60800, 74000, 107100, 139300],
          12: [88200, 107500, 155700, 202000],
          13: [126300, 154400, 224700, 291800],
          14: [182700, 223400, 325500, 422700],
          15: [210100, 256900, 374400, 486100],
          16: [241600, 295400, 430500, 559000],
          17: [277800, 339700, 495000, 642900],
        };
      },

      // ---------------------------
      // AGE INDEX
      // ---------------------------
      getAgeIndex: function(age) {
        if (age <= 15) return 0;
        if (age <= 20) return 1;
        if (age <= 25) return 2;
        if (age <= 30) return 3;
        if (age <= 35) return 4;
        if (age <= 40) return 5;
        if (age <= 45) return 6;
        if (age <= 50) return 7;
        if (age <= 55) return 8;
        if (age <= 59) return 9;
        if (age <= 65) return 10;
        if (age <= 70) return 11;
        if (age <= 75) return 12;
        if (age <= 80) return 13;
        if (age <= 85) return 14;
        if (age <= 90) return 15;
        if (age <= 95) return 16;
        return 17;
      },

      normalizeBandIndex: function(type, bandIndex) {
        if (type === "HH") return bandIndex;
        if (type === "HSX" || type === "HSV") {
          if (bandIndex === 9) return 9;
          if (bandIndex === 10) return 10;
        }
        return bandIndex;
      },

      calculatePremium: function(type, idx, bandIndex, gender) {
        const g = (gender === "male") ? "male" : "female";
        const tBand = this.normalizeBandIndex(type, bandIndex);
        const row = this.rateTable?.[type]?.[g]?.[tBand];

        if (!row) return 0;
        const val = row[idx];
        if (!val || val <= 0) return 0;
        return val;
      },

      // ---------------------------
      // DECISION BAR
      // ---------------------------
      computePlanPremiums: function(ageIdx, gender) {
        return [1,2,3].map(col => {
          const { type, idx } = this.state[col];
          return this.calculatePremium(type, idx, ageIdx, gender);
        });
      },

      updateDecisionBar: function(ageIdx, gender) {
        const premiums = this.computePlanPremiums(ageIdx, gender);
        const minVal = Math.min(...premiums);
        const maxVal = Math.max(...premiums);
        const bestCol = premiums.indexOf(minVal) + 1;

        let bestPlanName =
          document.getElementById(`head-${bestCol}`)?.innerText?.split("\n")?.slice(0,2)?.join(" ")
          || `PLAN ${bestCol}`;

        document.getElementById("best-plan-name").textContent = bestPlanName.trim();
        document.getElementById("best-plan-save").textContent = `${this.formatMoney(maxVal - minVal)} ‡∏ö‡∏≤‡∏ó`;

        document.getElementById("delta-chips").innerHTML = premiums.map((v, i) => {
          const col = i + 1;
          const delta = v - minVal;
          const pct = minVal > 0 ? Math.round((delta / minVal) * 100) : 0;
          if (delta === 0) {
            return `<span class="px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 text-xs font-extrabold border border-emerald-200">PLAN ${col}: ‡∏Ñ‡∏∏‡πâ‡∏°‡∏™‡∏∏‡∏î</span>`;
          }
          return `<span class="px-2 py-1 rounded-full bg-slate-100 text-slate-800 text-xs font-extrabold border border-slate-200">PLAN ${col}: +${this.formatMoney(delta)} (+${pct}%)</span>`;
        }).join("");

        for (let col = 1; col <= 3; col++) {
          const prem = premiums[col - 1];
          const el = document.getElementById(`plan-highlight-${col}`);
          if (!el) continue;

          if (prem === minVal) el.textContent = "‡∏Ñ‡∏∏‡πâ‡∏°‡∏™‡∏∏‡∏î / ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î";
          else if (prem === maxVal) el.textContent = "‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡πÅ‡∏ô‡πà‡∏ô‡∏™‡∏∏‡∏î / ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≤‡∏¢‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°";
          else el.textContent = "‡∏ö‡∏≤‡∏•‡∏≤‡∏ô‡∏ã‡πå‡∏î‡∏µ / ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°";
        }
      },

      // ---------------------------
      // SELECTOR
      // ---------------------------
      changeType: function(col, newType) {
        this.state[col].type = newType;
        this.state[col].idx = 0;
        this.renderSelectors(col);
        this.updateHeader(col);
        this.renderBody();
        this.reCalculate();
      },

      changeOption: function(col, newIdx) {
        this.state[col].idx = parseInt(newIdx);
        this.updateHeader(col);
        this.renderBody();
        this.reCalculate();
      },

      renderSelectors: function(col) {
        const cur = this.state[col];
        document.getElementById(`type-${col}`).innerHTML = Object.keys(this.plans).map(key =>
          `<option value="${key}" ${key === cur.type ? 'selected' : ''}>${this.plans[key].name}</option>`
        ).join('');

        document.getElementById(`idx-${col}`).innerHTML = this.plans[cur.type].options.map((opt, i) =>
          `<option value="${i}" ${i === cur.idx ? 'selected' : ''}>${opt.name}</option>`
        ).join('');
      },

      updateHeader: function(col) {
        const cur = this.state[col];
        const data = this.plans[cur.type];
        const opt = data.options[cur.idx];

        const th = document.getElementById(`head-${col}`);
        th.className = `p-4 align-top border-b-4 transition-colors ${data.bg} ${data.border}`;
        th.innerHTML = `
          <div class="flex flex-col gap-1 fade-in">
            <div class="text-xl font-extrabold text-slate-900 leading-tight">${data.name}</div>
            <div class="text-lg font-extrabold text-amber-700">${opt.name}</div>
            <div class="text-xs text-slate-500">${data.subtitle}</div>

            <div class="mt-2">
              <span class="inline-block px-3 py-1 bg-white border border-slate-300 rounded-full text-xs font-extrabold text-slate-700 shadow-sm">
                ‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô: ${opt.limit}
              </span>
            </div>

            <div class="mt-3 flex items-center justify-center gap-2">
              <button onclick="app.pickPlan(${col})"
                class="w-full px-3 py-2 rounded-xl font-extrabold text-sm text-[#111827]
                       bg-gradient-to-r from-[#fbbf24] to-[#f59e0b]
                       shadow-lg hover:brightness-105 active:scale-[0.99] transition">
                ‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤
              </button>
            </div>

            <div class="mt-2 text-[11px] text-slate-600">
              ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô: <span id="plan-highlight-${col}" class="font-extrabold text-slate-900">-</span>
            </div>
          </div>
        `;

        const projHead = document.getElementById(`proj-head-${col}`);
        if (projHead) {
          projHead.innerHTML = `<span class="text-xs block text-slate-400">${data.name}</span><span class="text-sm text-amber-700 font-extrabold">${opt.name}</span>`;
        }
      },

      // ---------------------------
      // RECALC
      // ---------------------------
      reCalculate: function() {
        const gender = document.getElementById('input-gender').value;
        const age = parseInt(document.getElementById('input-age').value);
        const ageIdx = this.getAgeIndex(age);

        this.quoteState.selectedCol = null;

        [1,2,3].forEach(col => {
          const { type, idx } = this.state[col];
          const premium = this.calculatePremium(type, idx, ageIdx, gender);
          const el = document.getElementById(`prem-${col}`);
          el.innerHTML = (premium || 0).toLocaleString();
          el.classList.remove('fade-in');
          void el.offsetWidth;
          el.classList.add('fade-in');
        });

        this.renderPremiumTable(ageIdx, gender);
        this.updateDecisionBar(ageIdx, gender);
      },

      renderPremiumTable: function(startIdx, gender) {
        let html = '';
        for (let i = startIdx; i < this.ageBands.length; i++) {
          const band = this.ageBands[i];
          const p1 = this.calculatePremium(this.state[1].type, this.state[1].idx, i, gender);
          const p2 = this.calculatePremium(this.state[2].type, this.state[2].idx, i, gender);
          const p3 = this.calculatePremium(this.state[3].type, this.state[3].idx, i, gender);

          const isRenewal = band.includes("*");
          const highlight = (i === startIdx)
            ? 'bg-gradient-to-r from-[#fff7ed] to-[#fffbeb] font-extrabold border-l-4 border-[#f59e0b]'
            : '';

          html += `
            <tr class="hover:bg-slate-50 transition-colors ${highlight} ${isRenewal ? 'bg-slate-50' : ''}">
              <td class="p-3 border-b border-slate-100">${band}</td>
              <td class="p-3 border-b border-slate-100 text-slate-900 font-bold">${(p1||0).toLocaleString()}</td>
              <td class="p-3 border-b border-slate-100 text-slate-900 font-bold">${(p2||0).toLocaleString()}</td>
              <td class="p-3 border-b border-slate-100 text-slate-900 font-bold">${(p3||0).toLocaleString()}</td>
            </tr>
          `;
        }
        document.getElementById('premium-table-body').innerHTML = html;
      },

      // ---------------------------
      // QUOTATION MODAL
      // ---------------------------
      pickPlan: function(col) {
        this.openQuote(col);
      },

      openQuote: function(col) {
        const gender = document.getElementById('input-gender').value;
        const age = parseInt(document.getElementById('input-age').value);
        const ageIdx = this.getAgeIndex(age);

        this.quoteState.selectedCol = col;
        this.quoteState.gender = gender;
        this.quoteState.age = age;
        this.quoteState.ageIdx = ageIdx;

        const { type, idx } = this.state[col];
        const planName = this.plans[type].name;
        const optName = this.plans[type].options[idx].name;
        const premium = this.calculatePremium(type, idx, ageIdx, gender);

        document.getElementById("quote-subtitle").textContent =
          `‡∏≠‡∏≤‡∏¢‡∏∏ ${age} ‡∏õ‡∏µ ¬∑ ‡πÄ‡∏û‡∏®${gender === "male" ? "‡∏ä‡∏≤‡∏¢" : "‡∏´‡∏ç‡∏¥‡∏á"} ¬∑ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${new Date().toLocaleDateString('th-TH')}`;

        document.getElementById("quote-plan").textContent = `PLAN ${col}`;
        document.getElementById("quote-option").textContent = `${planName} ‚Äî ${optName}`;
        document.getElementById("quote-premium").textContent = `${this.formatMoney(premium)} ‡∏ö‡∏≤‡∏ó`;

        const highlight = document.getElementById(`plan-highlight-${col}`)?.textContent || "-";
        document.getElementById("quote-highlight").textContent = highlight;

        this.renderQuoteCompare(ageIdx, gender);
        this.renderHistory();

        document.getElementById("quote-modal").classList.remove("hidden");
        lucide.createIcons();
      },

      closeQuote: function() {
        document.getElementById("quote-modal").classList.add("hidden");
      },

      renderQuoteCompare: function(ageIdx, gender) {
        const premiums = this.computePlanPremiums(ageIdx, gender);
        const minVal = Math.min(...premiums);

        document.getElementById("quote-compare-note").textContent =
          `‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏à‡∏≤‡∏Å‡πÅ‡∏ú‡∏ô‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡∏î: ${this.formatMoney(minVal)} ‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ`;

        let html = "";
        for (let col = 1; col <= 3; col++) {
          const { type, idx } = this.state[col];
          const planName = this.plans[type].name;
          const optName = this.plans[type].options[idx].name;
          const premium = premiums[col - 1];
          const delta = premium - minVal;
          const pct = minVal > 0 ? Math.round((delta / minVal) * 100) : 0;

          const isSelected = (col === this.quoteState.selectedCol);
          const rowClass = isSelected ? "bg-amber-50" : "bg-white";

          html += `
            <tr class="${rowClass}">
              <td class="p-3 font-extrabold text-slate-900">PLAN ${col}${isSelected ? ' <span class="text-amber-700">(‡πÄ‡∏•‡∏∑‡∏≠‡∏Å)</span>' : ''}</td>
              <td class="p-3 text-slate-700">
                <div class="font-extrabold">${planName}</div>
                <div class="text-xs text-slate-500">${optName}</div>
              </td>
              <td class="p-3 text-right font-extrabold text-slate-900">${this.formatMoney(premium)} ‡∏ö‡∏≤‡∏ó</td>
              <td class="p-3 text-right">
                ${
                  delta === 0
                    ? `<span class="px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 text-xs font-extrabold border border-emerald-200">‡∏Ñ‡∏∏‡πâ‡∏°‡∏™‡∏∏‡∏î</span>`
                    : `<span class="text-slate-700 font-extrabold">+${this.formatMoney(delta)} (+${pct}%)</span>`
                }
              </td>
            </tr>
          `;
        }
        document.getElementById("quote-compare-body").innerHTML = html;
      },

      exportQuotePDF: function() {
        if (document.getElementById("quote-modal").classList.contains("hidden")) {
          this.openQuote(this.quoteState.selectedCol || 1);
        }
        window.print();
      },

      getQuoteText: function() {
        const col = this.quoteState.selectedCol ?? 1;
        const gender = this.quoteState.gender ?? document.getElementById('input-gender').value;
        const age = this.quoteState.age ?? parseInt(document.getElementById('input-age').value);
        const ageIdx = this.quoteState.ageIdx ?? this.getAgeIndex(age);

        const { type, idx } = this.state[col];
        const planName = this.plans[type].name;
        const optName = this.plans[type].options[idx].name;
        const premium = this.calculatePremium(type, idx, ageIdx, gender);

        const customer = this.getCustomerData();

        const premiums = this.computePlanPremiums(ageIdx, gender);
        const minVal = Math.min(...premiums);
        const delta = premium - minVal;
        const pct = minVal > 0 ? Math.round((delta / minVal) * 100) : 0;

        const highlight = document.getElementById(`plan-highlight-${col}`)?.textContent || "";

        return [
          "üìå ‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ (Quotation)",
          `‚Ä¢ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${customer.name || "-"}`,
          `‚Ä¢ ‡πÄ‡∏ö‡∏≠‡∏£‡πå: ${customer.phone || "-"}`,
          `‚Ä¢ ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á: ${customer.channel || "-"}`,
          customer.note ? `‚Ä¢ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${customer.note}` : "",
          "",
          `‚Ä¢ ‡∏≠‡∏≤‡∏¢‡∏∏: ${age} ‡∏õ‡∏µ`,
          `‚Ä¢ ‡πÄ‡∏û‡∏®: ${gender === "male" ? "‡∏ä‡∏≤‡∏¢" : "‡∏´‡∏ç‡∏¥‡∏á"}`,
          "",
          `‚úÖ ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: PLAN ${col}`,
          `‚Ä¢ ‡∏™‡∏±‡∏ç‡∏ç‡∏≤: ${planName}`,
          `‚Ä¢ ‡πÅ‡∏ú‡∏ô: ${optName}`,
          `‚Ä¢ ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏õ‡∏µ‡∏ô‡∏µ‡πâ: ${this.formatMoney(premium)} ‡∏ö‡∏≤‡∏ó`,
          highlight ? `‚Ä¢ ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô: ${highlight}` : "",
          "",
          delta === 0
            ? "‚≠ê ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô"
            : `‚Ä¢ ‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏ú‡∏ô‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡∏î: +${this.formatMoney(delta)} ‡∏ö‡∏≤‡∏ó (+${pct}%)`,
          "",
          "‚ö° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°"
        ].filter(Boolean).join("\n");
      },

      copyQuoteText: async function() {
        const text = this.getQuoteText();
        try {
          await navigator.clipboard.writeText(text);
          alert("‚úÖ Copy ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡πâ‡∏ß (‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á LINE/FB)");
        } catch (e) {
          console.warn(e);
          alert("‚ùå Copy ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï\n‡∏ú‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Console ‡πÅ‡∏•‡πâ‡∏ß (F12)");
          console.log(text);
        }
      },

      confirmPlan: function() {
        alert("‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏ú‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢\n\n‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ:\n1) ‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤\n2) ‡∏ô‡∏±‡∏î‡∏ß‡∏±‡∏ô‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£/‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡πâ‡∏¢\n3) ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢");
        console.log("CONFIRMED PLAN TEXT:\n" + this.getQuoteText());
      },

      // ---------------------------
      // COVERAGE TABLE
      // ---------------------------
      renderBody: function() {
        let html = "";
        html += this.createSection("1. ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô (IPD)");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 1: ‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á (‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô)", "cat1", "bed", "‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 125 ‡∏´‡∏£‡∏∑‡∏≠ 365 ‡∏ß‡∏±‡∏ô");
        html += this.createRow("‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á ICU (‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô)", "cat1", "activity", "‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ï‡∏≤‡∏°‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô (x2) ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏≤");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 2: ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå", "cat2", "stethoscope", "‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤, ‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå, ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 3: ‡∏Ñ‡πà‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î", "cat3", "scissors");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 4: ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡πÑ‡∏Ç‡πâ (‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô)", "cat4", "user-check");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 5: ‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô", "cat5", "sun", "Day Surgery");

        html += this.createSection("2. ‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏´‡∏°‡∏ß‡∏î 6-13)");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 6: ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢", "cat6", "microscope", "‡∏Å‡πà‡∏≠‡∏ô/‡∏´‡∏•‡∏±‡∏á ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ó");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 7: ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô", "cat2", "zap", "‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏°.");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 8: ‡πÄ‡∏ß‡∏ä‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π", "cat2", "person-standing");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 9: ‡∏•‡πâ‡∏≤‡∏á‡πÑ‡∏ï", "cat9", "droplet", "‡∏ï‡πà‡∏≠‡∏õ‡∏µ‡∏Å‡∏£‡∏°‡∏ò‡∏£‡∏£‡∏°‡πå");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 10: ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á", "cat10", "biohazard", "‡πÄ‡∏Ñ‡∏°‡∏µ/‡∏£‡∏±‡∏á‡∏™‡∏µ ‡∏ï‡πà‡∏≠‡∏õ‡∏µ");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 11: ‡∏£‡∏ñ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•", "cat11", "ambulance");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 12: ‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î‡πÄ‡∏•‡πá‡∏Å", "cat2", "pen-tool");
        html += this.createRow("‡∏´‡∏°‡∏ß‡∏î 13: ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏Å (OPD)", "opd", "users", "‡∏ï‡πà‡∏≠‡∏õ‡∏µ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ï‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á");

        html += this.createSection("3. ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°");
        html += this.createSpecialRow_CI();
        html += this.createRow("‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (No Claim Bonus)", "ncb", "piggy-bank");
        html += this.createRow("‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï", "death", "heart");

        document.getElementById('table-body').innerHTML = html;
        lucide.createIcons();
      },

      createRow: function(label, key, icon, sub = "") {
        return `
          <tr class="group">
            <td class="p-3 pl-4 border-r border-slate-100 bg-white sticky-col z-10">
              <div class="flex items-center gap-2 font-bold text-slate-700">
                ${icon ? `<i data-lucide="${icon}" class="w-4 h-4 text-slate-400"></i>` : ''} ${label}
              </div>
              ${sub ? `<div class="text-[10px] text-slate-400 ml-6">${sub}</div>` : ''}
            </td>
            ${[1,2,3].map(col => {
              const { type, idx } = this.state[col];
              const d = this.plans[type].options[idx];
              return `<td class="p-3 text-center border-l border-slate-100">${this.renderCell(d[key], key === 'cat1')}</td>`;
            }).join('')}
          </tr>
        `;
      },

      createSpecialRow_CI: function() {
        return `
          <tr class="group hover:bg-red-50 transition-colors">
            <td class="p-3 pl-4 border-r border-slate-100 bg-white sticky-col z-10">
              <div class="flex items-center gap-2 font-bold text-slate-700">
                <i data-lucide="shield-alert" class="w-4 h-4 text-red-500"></i> ‡πÇ‡∏£‡∏Ñ‡∏£‡πâ‡∏≤‡∏¢‡πÅ‡∏£‡∏á (CI Double)
              </div>
              <div class="text-[10px] text-slate-400 ml-6">‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô 2 ‡πÄ‡∏ó‡πà‡∏≤ (4 ‡∏õ‡∏µ‡∏Å‡∏£‡∏°‡∏ò‡∏£‡∏£‡∏°‡πå)</div>
            </td>
            ${[1,2,3].map(col => {
              const { type, idx } = this.state[col];
              const d = this.plans[type].options[idx];
              let val = "-";
              if (type !== 'HSX') val = `2 ‡πÄ‡∏ó‡πà‡∏≤ (${d.limit})`;
              return `<td class="p-3 text-center border-l border-slate-100 text-sm">
                ${val === '-' ? '-' : `<span class="bg-red-100 text-red-700 px-2 py-0.5 rounded border border-red-200 font-extrabold">${val}</span>`}
              </td>`;
            }).join('')}
          </tr>
        `;
      },

      createSection: function(title) {
        return `<tr class="bg-slate-100 border-y border-slate-200">
          <td colspan="4" class="py-2 px-4 text-xs font-extrabold text-slate-600 uppercase tracking-wide">${title}</td>
        </tr>`;
      },

      renderCell: function(val, isBold = false) {
        if (val === "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢" || val === "‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á") return `<span class="font-extrabold text-pink-600">‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á</span>`;
        if (val && (val.includes("‡πÄ‡∏´‡∏°‡∏≤‡∏à‡πà‡∏≤‡∏¢") || val.includes("‡∏£‡πà‡∏ß‡∏°"))) return `<span class="font-bold text-sky-700 text-xs md:text-sm">${val}</span>`;
        if (val === "-" || val === "‡πÑ‡∏°‡πà‡∏°‡∏µ") return `<span class="text-slate-300">-</span>`;
        return `<span class="text-slate-900 ${isBold ? 'font-extrabold' : 'font-bold'}">${val}</span>`;
      }
    };

    document.addEventListener('DOMContentLoaded', () => {
      app.init();
      lucide.createIcons();
    });
  </script>
</body>
</html>
